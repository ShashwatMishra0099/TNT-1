<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Wordable Game</title>
  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* Board cell styling */
    .cell {
      width: 3.5rem;
      height: 3.5rem;
      border: 2px solid #d1d5db;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 1.5rem;
      font-weight: 600;
      text-transform: uppercase;
      transition: background-color 0.3s, border-color 0.3s;
    }
    .active {
      border-color: #2563eb;
    }
    /* Color coding after guess is submitted */
    .correct {
      background-color: #6aaa64;
      border-color: #6aaa64;
      color: #fff;
    }
    .present {
      background-color: #c9b458;
      border-color: #c9b458;
      color: #fff;
    }
    .absent {
      background-color: #787c7e;
      border-color: #787c7e;
      color: #fff;
    }
    /* Virtual keyboard button styles */
    .vk-btn {
      min-width: 2rem;
      margin: 0.2rem;
      padding: 0.5rem 0.7rem;
      border: none;
      border-radius: 0.25rem;
      background-color: #e5e7eb;
      font-weight: 600;
      cursor: pointer;
      transition: background-color 0.2s;
    }
    .vk-btn:hover {
      background-color: #d1d5db;
    }
  </style>
</head>
<body class="bg-gradient-to-br from-blue-200 to-purple-200 min-h-screen flex flex-col items-center p-4">
  <div class="bg-white p-6 rounded-lg shadow-xl max-w-md w-full">
    <div class="flex justify-between items-center mb-4">
      <h1 class="text-2xl font-bold">Wordable Game</h1>
      <button id="new-game" class="bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600">New Game</button>
    </div>
    <div id="board" class="grid grid-cols-5 gap-2 mb-4"></div>
    <div id="message" class="text-center mb-4 text-lg font-semibold"></div>
    <!-- Virtual keyboard -->
    <div id="keyboard" class="mb-4">
      <!-- We'll create three rows of keys -->
      <div class="flex justify-center mb-1" id="row1"></div>
      <div class="flex justify-center mb-1" id="row2"></div>
      <div class="flex justify-center" id="row3"></div>
    </div>
    <p class="text-center text-sm text-gray-600">Use your physical keyboard (or tap the on-screen keys) and swipe to move the active cell.</p>
  </div>

  <script>
    // --- Game Setup ---
    const ROWS = 6, COLS = 5;
    let board = [];
    let currentRow = 0, currentCol = 0;
    let gameOver = false;
    // A small word list and pick a random target word (5 letters)
    const wordList = ["apple", "crane", "brave", "spare", "light", "quick", "flame"];
    let targetWord = wordList[Math.floor(Math.random() * wordList.length)].toUpperCase();

    // Create an empty board (2D array)
    function initBoard() {
      board = [];
      for (let r = 0; r < ROWS; r++) {
        let row = [];
        for (let c = 0; c < COLS; c++) {
          row.push("");
        }
        board.push(row);
      }
      currentRow = 0;
      currentCol = 0;
      gameOver = false;
      document.getElementById("message").textContent = "";
      renderBoard();
    }

    // --- Rendering Functions ---
    function renderBoard() {
      const boardEl = document.getElementById("board");
      boardEl.innerHTML = "";
      for (let r = 0; r < ROWS; r++) {
        for (let c = 0; c < COLS; c++) {
          const cell = document.createElement("div");
          cell.classList.add("cell");
          cell.dataset.row = r;
          cell.dataset.col = c;
          cell.textContent = board[r][c];
          // Highlight the active cell if we're in the current row
          if (r === currentRow && c === currentCol && !gameOver) {
            cell.classList.add("active");
          }
          boardEl.appendChild(cell);
        }
      }
    }

    // Create virtual keyboard
    const keyboardLayout = [
      ["Q","W","E","R","T","Y","U","I","O","P"],
      ["A","S","D","F","G","H","J","K","L"],
      ["Enter","Z","X","C","V","B","N","M","Back"]
    ];

    function renderKeyboard() {
      keyboardLayout.forEach((rowKeys, rowIndex) => {
        const rowEl = document.getElementById("row" + (rowIndex+1));
        rowEl.innerHTML = "";
        rowKeys.forEach(key => {
          const btn = document.createElement("button");
          btn.className = "vk-btn";
          btn.textContent = key;
          btn.addEventListener("click", () => handleKey(key));
          rowEl.appendChild(btn);
        });
      });
    }

    // --- Game Logic ---
    function handleKey(key) {
      if (gameOver) return;
      if (key === "Enter") {
        submitGuess();
      } else if (key === "Back") {
        deleteLetter();
      } else if (/^[A-Z]$/.test(key)) {
        addLetter(key);
      }
    }

    function addLetter(letter) {
      if (currentCol < COLS) {
        board[currentRow][currentCol] = letter;
        currentCol++;
        renderBoard();
      }
    }

    function deleteLetter() {
      if (currentCol > 0) {
        currentCol--;
        board[currentRow][currentCol] = "";
        renderBoard();
      }
    }

    function submitGuess() {
      if (currentCol < COLS) return; // Not enough letters
      const guess = board[currentRow].join("");
      // Evaluate the guess if it is 5 letters
      const evaluation = evaluateGuess(guess, targetWord);
      // Color the cells based on evaluation
      for (let c = 0; c < COLS; c++) {
        const cellIndex = currentRow * COLS + c;
        const cell = document.getElementById("board").children[cellIndex];
        cell.classList.add(evaluation[c]);
      }
      // Check win condition
      if (guess === targetWord) {
        document.getElementById("message").textContent = "Congratulations! You guessed it!";
        gameOver = true;
        return;
      }
      // Move to next row or end game
      currentRow++;
      currentCol = 0;
      if (currentRow === ROWS) {
        document.getElementById("message").textContent = "Game Over! The word was " + targetWord;
        gameOver = true;
      }
      renderBoard();
    }

    // Wordle-like evaluation: mark each letter as 'correct', 'present', or 'absent'
    function evaluateGuess(guess, target) {
      guess = guess.toUpperCase();
      target = target.toUpperCase();
      let result = Array(COLS).fill("absent");
      let targetArr = target.split("");

      // First pass: correct positions
      for (let i = 0; i < COLS; i++) {
        if (guess[i] === target[i]) {
          result[i] = "correct";
          targetArr[i] = null;
        }
      }
      // Second pass: present letters
      for (let i = 0; i < COLS; i++) {
        if (result[i] !== "correct" && targetArr.includes(guess[i])) {
          result[i] = "present";
          targetArr[targetArr.indexOf(guess[i])] = null;
        }
      }
      return result;
    }

    // --- Input Handling (Keyboard and Arrow Keys) ---
    document.addEventListener("keydown", (event) => {
      if (gameOver) return;
      if (event.key === "Enter") {
        submitGuess();
      } else if (event.key === "Backspace") {
        deleteLetter();
      } else if (/^[a-zA-Z]$/.test(event.key)) {
        addLetter(event.key.toUpperCase());
      } else if (event.key === "ArrowLeft") {
        if (currentCol > 0) { currentCol--; renderBoard(); }
      } else if (event.key === "ArrowRight") {
        if (currentCol < COLS && board[currentRow][currentCol] !== "") { currentCol++; renderBoard(); }
      }
      // For ArrowUp and ArrowDown, we let the user navigate within the current row if desired.
      else if (event.key === "ArrowUp") {
        if (currentRow > 0) { currentRow--; renderBoard(); }
      } else if (event.key === "ArrowDown") {
        if (currentRow < ROWS - 1) { currentRow++; renderBoard(); }
      }
    });

    // --- Touch Swipe Support for Moving Active Cell ---
    let touchStartX = null, touchStartY = null;
    const swipeThreshold = 50; // minimum distance in px

    document.addEventListener("touchstart", (e) => {
      touchStartX = e.changedTouches[0].screenX;
      touchStartY = e.changedTouches[0].screenY;
    }, false);

    document.addEventListener("touchend", (e) => {
      if (gameOver) return;
      const touchEndX = e.changedTouches[0].screenX;
      const touchEndY = e.changedTouches[0].screenY;
      const diffX = touchEndX - touchStartX;
      const diffY = touchEndY - touchStartY;

      if (Math.abs(diffX) > Math.abs(diffY)) {
        // Horizontal swipe
        if (diffX > swipeThreshold && currentCol > 0) {
          currentCol--;
        } else if (diffX < -swipeThreshold && currentCol < COLS - 1) {
          currentCol++;
        }
      } else {
        // Vertical swipe
        if (diffY > swipeThreshold && currentRow > 0) {
          currentRow--;
        } else if (diffY < -swipeThreshold && currentRow < ROWS - 1) {
          currentRow++;
        }
      }
      renderBoard();
    }, false);

    // --- New Game Button ---
    document.getElementById("new-game").addEventListener("click", () => {
      // Choose a new random word
      targetWord = wordList[Math.floor(Math.random() * wordList.length)].toUpperCase();
      initBoard();
    });

    // --- Initialization ---
    renderKeyboard();
    initBoard();
  </script>
</body>
</html>
