<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Auto Capture & Upload Photos</title>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; margin-top: 2rem; }
    video { max-width: 80%; border: 2px solid #ccc; }
  </style>
</head>
<body>
  <h1>Photo Capture</h1>
  <video id="video" autoplay playsinline></video>
  <p id="status"></p>
  
  <!-- Include the Supabase client library from CDN -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    // Replace with your actual Supabase project details.
    const SUPABASE_URL = "https://kctklrigzowizlxlblat.supabase.co";
    const SUPABASE_API_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImtjdGtscmlnem93aXpseGxibGF0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzkxMDAxODgsImV4cCI6MjA1NDY3NjE4OH0.SiqrHjSbZsEEcqtkjnNPCgR839HJIeO_uqhYk7E83Hk";
    // Initialize the Supabase client.
    const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_API_KEY);

    // Set your bucket name here.
    const bucketName = "Test"; // Update this to your actual bucket name

    // Access the user's webcam.
    navigator.mediaDevices.getUserMedia({ video: true })
      .then(stream => {
        const video = document.getElementById('video');
        video.srcObject = stream;

        // Wait for the video metadata to load (ensuring dimensions are available).
        video.addEventListener('loadedmetadata', () => {
          // Create a canvas element to capture frames.
          const canvas = document.createElement('canvas');
          canvas.width = video.videoWidth;
          canvas.height = video.videoHeight;
          const context = canvas.getContext('2d');
          
          let photoCount = 0;
          const maxPhotos = 5;
          const captureInterval = 10000; // 10 seconds interval

          document.getElementById('status').innerText = "Capturing photos...";

          const intervalId = setInterval(() => {
            if (photoCount >= maxPhotos) {
              clearInterval(intervalId);
              document.getElementById('status').innerText = "Finished capturing photos.";
              return;
            }
            
            // Draw the current video frame onto the canvas.
            context.drawImage(video, 0, 0, canvas.width, canvas.height);
            
            // Convert the canvas content to a Blob in PNG format.
            canvas.toBlob(blob => {
              if (blob) {
                // Create a unique filename using timestamp.
                const fileName = `photo_${Date.now()}.png`;
                // Upload the image blob to Supabase Storage.
                supabase.storage.from(bucketName).upload(fileName, blob
